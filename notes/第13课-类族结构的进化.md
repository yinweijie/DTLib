需要构建如下的类继承关系：

![](https://md-pic-1259272405.cos.ap-guangzhou.myqcloud.com/img/20200511163256.png)

即让所有的类都继承顶层父类`Object`，这样所有子类的对象调用`new`操作符的时候，都是使用重载版本的`operator new`，保证不会抛出异常，而只返回空指针。因为有些平台是不支持抛出异常的。同时，尽量少用到标准库中的函数，增加了可移植性。

做了如下改动：

1. 让`SmartPointer`和`Exception`都继承`Object`
2. 增加`InvalidOperationException`类，继承自`Exception`类
3. 在`Exception`中增加一个`if`判断，如果分配内存成功才给`m_location`赋值。不需要额外增加else去抛出异常类，此时`Exception`还没构建完成，抛出异常类会进入死循环
4. 测试用`new`操作符创建一个`Smartpointer`类，看是否调用顶层父类`Object`的`operator new`操作符。经过重载的`new`和`delete`是不会抛出异常的